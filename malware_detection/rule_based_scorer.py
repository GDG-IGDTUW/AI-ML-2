def compute_rule_score(row):
    score = 0
    
    # High-risk permissions
    high_risk_permissions = [
        "SEND_SMS",
        "READ_SMS",
        "READ_CONTACTS",
        "RECORD_AUDIO",
        "WRITE_EXTERNAL_STORAGE"
    ]
    
    for perm in high_risk_permissions:
        if perm in row.index and row[perm] == 1:
            score += 3
    
    # Medium risk
    if "INTERNET" in row.index and row["INTERNET"] == 1:
        score += 1
        
    # Too many permissions
    if sum(row) > 15:
        score += 2
        
    return score


def classify_by_rule(score, threshold=6):
    if score >= threshold:
        return "Malware"
    else:
        return "Benign"