import os
import hashlib
import math
from collections import Counter
from pathlib import Path


def get_info(f):
        info = {}
        content = f.read()
        entropy = calculate_entropy(content)
        if entropy > 7.5:
             suspicious = "⚠️ Yes (High Entropy)"
        else:
             suspicious = "✅ No"

        info['File Name'] = f.name
        info['Size (KB)'] = len(content) / 1024
        info['Entropy'] = calculate_entropy(content)
        info['MD5'] = hashlib.md5(content).hexdigest()
        info['SHA256'] = hashlib.sha256(content).hexdigest()
        info["Suspicious"]=suspicious
        
             
               
        

        suffix = Path(f.name).suffix.lower()
        info['Type'] = {
            '.exe': 'Windows Executable',
            '.txt': 'Text File'
        }.get(suffix, 'Unknown')


        return info
def calculate_entropy(data):
        if not data:
            return 0
        byte_counts = Counter(data)
        probabilities = [count / len(data) for count in byte_counts.values()]
        entropy =-sum(p * math.log2(p) for p in probabilities)
        return round(entropy, 3)
